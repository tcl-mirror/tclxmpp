2009-02-11  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/private.tcl: Added simple interface to private XML storage
	  (XEP-0049).

	* xmpp/annotations.tcl: Added storing/retieving roster notes
	  (XEP-0145).

	* xmpp/delimiter.tcl: Added storing/retrieving nested groups delimiter
	  (XEP-0083).

	* xmpp/metacontacts.tcl: Added storing/retrieving roster metacontacts
	  (XEP-0209).

	* xmpp/pkgIndex.tcl: Added the above packages.

	* xmpp/bookmarks.tcl, xmpp/pkgIndex.tcl: Added storing/retrieving
	  conference bookmarks (XEP-0048).

2009-02-10  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/tls.tcl: Changed -password option to -passwordcommand to avoid
	  clash with password for proxy.

2009-02-09  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/https.tcl: Changed HTTP protocol version in CONNECT query
	  from 1.1 to 1.0.

2008-12-17  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/poll.tcl: Fixed return value for procedure which pushes text
	  to an XMPP server.

2008-12-14  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl: Don't allow arbitrary message type. Made debug
	  messages a bit more clear and added timestamp to them.

2008-11-18  Sergei Golovan  <sgolovan@nes.ru>

	* doc/*.man: Made ViM modelines prettier.

2008-11-09  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl: Added a new log callback which is invoked on every
	  outgoing and incoming packet.

2008-11-03  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/tcp.tcl, xmpp/zlib.tcl: Fixed typo in a procedure which returns
	  connection socket IP address.

	* xmpp/negotiate.tcl, pkgIndex.tcl: Added a package which implements
	  feature negotiation protocol (XEP-0020).

	* xmpp/poll.tcl: Fixed typo.

	* xmpp/data.tcl: Fixed typo.

2008-11-02  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/data.tcl: Added a procedure which fills in form fields for
	  submission.

	* xmpp/search.tcl, xmpp/pkgIndex.tcl: Added a package which implements
	  support for Jabber Search (XEP-0055) queries.

	* xmpp/data.tcl: Treat missing form type as "form".

	* xmpp/search.tcl: Fixed typo and removed implicit field label.

	* xmpp/register.tcl, xmpp/pkgIndex.tcl: Added a new package which
	  implements support for In-Band Registration (XEP-0077) queries.

	* tclxml/*.tcl, doc/*.man, xmpp/register.tcl: Removed tabulation
	  characters from the sources and added ViM modelines which expand
	  them into spaces.

	* xmpp/xmpp.tcl: Don't add empty "to" attribute to sent IQ stanzas.

	* xmpp/register.tcl: Added support for data forms in error service
	  responses and added support for changing password.

	* xmpp/data.tcl: Added support for creating data forms.

	* xmpp/data.tcl: Added procedure which creates form field tuple in a
	  human readable way. Also, added field description and required
	  fields support for created data forms. Also, added basic result form
	  support.

2008-11-01  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/data.tcl, xmpp/pkgIndex.tcl: Added a new package for working
	  with data forms (XEP-0004).

	* xmpp/data.tcl: Return form type when searching for a data form.
	  Parse field elements in result forms.

	* xmpp/data.tcl: Fixed parsing items in a result form.

2008-10-31  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl: Protected unsetting of a variable which stores abort
	  commands because it may be unset during abort call.

2008-10-30  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/zlib.tcl: Protected reading from
	  the XMPP socket and disconnect it in case of read error.

2008-10-27  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/zlib.tcl: Removed calls to
	  non-existent fubction ::xmpp::log.

2008-10-25  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl: Don't check the from address for IQ relies and errors
	  because in order to be reliable it requires full JID normalization.
	  Use random IQ IDs to prevent accidental or malicious ID clashing.

	* xmpp/iq.tcl: Use empty string instead of "ignore" to signal that the
	  IQ answer will be later.

2008-10-24  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl: Fixed error stanza when aborting IQ on timeout, made
	  calling back when sending IQ failed to after idle, fixed IQ
	  callbacks to compare normalized JIDs when searching for reply.

2008-10-21  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xml.tcl: Fixed typo.

	* xmpp/https.tcl: Added missing close bracket.

	* xmpp/socks4.tcl: Fixed version number.

2008-10-20  Sergei Golovan  <sgolovan@nes.ru>

	* doc/xmpp_jid.man, doc/xmpp_xml.man: Removed colons from filenames
	  as they cause problems on non-Unix systems.

	* xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/zlib.tcl: Fixed variable name.

	* doc/xmpp.man: Added preliminary manual page for xmpp package.

	* xmpp/starttls.tcl, xmpp/tls.tcl: Changed -callback option to
	  -verifycommand and added -infocommand option which specifies
	  command to call upon successfully established TLS connection with
	  socket TLS status.

2008-10-19  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl: Fixed race condition where transport was already
	  closed, but was tried to send packets.

	* xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/zlib.tcl: Clear readable fileevent
	  script when the socket is closed by the other side. Otherwise it can
	  be triggered continuously. Also, close socket.

	* xmpp/xmpp.tcl: Removed unnecessary rescheduling of ForcedDisconnect
	  call which now can't be executed twice (one time on the end of
	  strteam, and another time on the closure of the socket).

	* xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/zlib.tcl: Removed unnecessary error
	  hidings by catch.

	* doc/xmpp::jid.man, doc/xmpp::xml.man: Added preliminary manual pages
	  for xmpp::jid and xmpp::xml packages. Currently they contain only
	  lists of commands.

	* xmpp/jid.tcl: Code cleanup.

2008-10-18  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/jid.tcl: Added default resource value (empty string).

	* xmpp/sasl.tcl: Use jid procedure instead of directly concatenating
	  user and server names.

	* xmpp/xmpp.tcl: Added packetID command which returns the next free
	  packet ID. Also, removed packet ID resetting on disconnect.

	* xmpp/xml.tcl: Added toTabbedText procedure for XML pretty-printing.

2008-10-17  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/streamerror.tcl: Added error condition to the call of error
	  client callback in additin to a readable message.

	* xmpp/xmpp.tcl: Return client callback code and error info to a
	  caller. It is useful for IQ callback where return code "return"
	  prevents processing the packet by internam IQ engine. Also, move
	  general IQ callback upper to make it executed not only for types
	  "get" and "set" but also for all other types.

	* xmpp/xml.tcl: Added a hack which helps to parse XML file with a
	  declararion at the beginning if tDOM parser is used. Also, fixed a
	  typo in create XML procedure.

	* xmpp/delay.tcl: Added a new procedure which checks if the message
	  is delayed.

	* xmpp/sasl.tcl: Renamed local variable which clashed with global one.

	* xmpp/auth.tcl, xmpp/compress.tcl, xmpp/sasl.tcl, xmpp/starttls.tcl:
	  Return full error stanza instead of error message.

	* xmpp/xmpp.tcl: Fixed transport switching.

	* xmpp/sasl.tcl: Fixed typo.

	* xmpp/xmpp.tcl: Fixed sending text.

	* xmpp/xml.tcl: Fixed creating XML element if it has empty subelements.

	* xmpp/streamerror.tcl: Removed extra closing parenthesis from error
	  message.

2008-10-15  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xml.tcl: Added default (empty) XMLNS for empty prefix. Also,
	  closed the outmost XML element in data parsing routine.

	* xmpp/xml.tcl: Fixed using of Tcl-only parser from data parsing
	  routine.

2008-10-14  Sergei Golovan  <sgolovan@nes.ru>

	* tclxml/sgmlparser.tcl, tclxml/tclparser.tcl, tclxml/xmltcl.tcl,
	  xmpp/xml.tcl: Use non-XMLNS aware parser and process XMLNS prefixes
	  manually. This helps to ignore unbound prefixes when tDOM expat
	  parser is used.

	* xmpp/iq.tcl: Fixed typo.

	* xmpp/socks4.tcl: Changed case of ok and error status.

	* xmpp/xml.tcl: Fixed bug with forgotten namespaces stack while
	  resetting XML parser. Also, simplified prefixes processing.

2008-10-13  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/starttls.tcl, xmpp/tls.tcl: Made TLS import routine use its
	  default options if they weren't specified during STARTTLS or
	  opening TLS socket. Added options to choose protocol version to
	  XMPP TLS interface.

	* xmpp/xmpp.tcl: Added general IQ command (unfinished yet).

2008-10-12  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/roster.tcl: Removed unnecessary argument from roster item
	  command call.

2008-10-11  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/xmpp.tcl, examples/chessbot.tcl, examples/echo.tcl,
	  examples/xsend.tcl: Changed syntax of host and port arguments in
	  ::xmpp::connect because they clashed with proxy host and port
	  options.

	* xmpp/compress.tcl, xmpp/starttls.tcl: Made the compress and starttls
	  procedures return new stream session ID in case of success. This
	  allows to perform non-SASL authentication over compressed or
	  encrypted streams if a server offers it.

	* xmpp/sasl.tcl: Fixed typo.

2008-10-10  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/delay.tcl: Joined procedures which create delay element
	  following different XEPs into a single procedure.

	* xmpp/dns.tcl: Replaced own procedure which returns nameservers list
	  by a procedure from the dns package. Added DNS lookup abort
	  procedure and procedures to resolve HTTP-poll and BOSH URLs.

	* examples/xsend.tcl, xmpp/https.tcl, xmpp/starttls.tcl, xmpp/xml.tcl,
	  xmpp/xmpp.tcl: Fitted code into 80-character width strings.

	* tclxml/*: Removed 8.1 suffix from file names because they will never
	  be used with Tcl 8.0 or older.

	* examples/xsend.tcl: Added note about the authors.

	* xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/zlib.tcl: Fixed bugs in abort
	  procedure where XML parser was destroyed unconditionally.

	* xmpp/zlib.tcl: Added -level option which allows to specify
	  compression level.

	* xmpp/socks4.tcl, xmpp/socks5.tcl: Moved to ::pconnect namespace.

	* xmpp/auth.tcl, xmpp/component.tcl, xmpp/ntlm.tcl, xmpp/pconnect.tcl,
	  xmpp/stanzaerror.tcl: Clarified descriptions.

	* xmpp/compress.tcl, xmpp/sasl.tcl, xmpp/starttls.tcl: Moved removing
	  stream features trace upper in abort procedures.

	* xmpp/poll.tcl: Changed -proxyHost, -proxyPort, -proxyUsername,
	  -proxyPassword and -proxyUseragent options to -host, -port,
	  -username, -password and -useragent to make them consistent with
	  ::pconnect::socket options.

	* xmpp/jid.tcl: Fixed file name in description.

	* xmpp/pkgIndex.tcl: Added xmpp::delay package.

	* xmpp/starttls.tcl: Changed -cacertstore option to -castore to make
	  it more similar to -cafile and -cadir.

	* xmpp/compress.tcl, xmpp/dns.tcl, xmpp/iq.tcl, xmpp/poll.tcl,
	  xmpp/starttls.tcl, xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/transport.tcl,
	  xmpp/zlib.tcl: Added descriptions to all defined procedures.

	* xmpp/compress.tcl: Added -level option to choose compression level
	  when switching transport to zlib.

	* examples/chessbot.tcl, examples/echo.tcl, examples/xsend.tcl,
	  xmpp/auth.tcl, xmpp/component.tcl, xmpp/poll.tcl, xmpp/roster.tcl,
	  xmpp/tcp.tcl, xmpp/tls.tcl, xmpp/transport.tcl, xmpp/xmpp.tcl,
	  xmpp/zlib.tcl: Removed camel case from dash-options.

	* xmpp/stanzaerror.tcl: Added creating legacy error to error
	  procedure (with -old option).

2008-10-09  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/auth.tcl: Added a few checks for existing authentication token
	  in callbacks. Also, did a little code cleanup and clarified
	  comments.

2008-10-08  Sergei Golovan  <sgolovan@nes.ru>

	* xmpp/transport.tcl, xmpp/poll.tcl, xmpp/tcp.tcl, xmpp/tls.tcl,
	  xmpp/zlib.tcl: Added ip command (it will be used when IP should be
	  reported to another JID, e.g. in file transfer).

	* xmpp/auth.tcl, xmpp/component.tcl, xmpp/compress.tcl, xmpp/sasl.tcl,
	  xmpp/starttls.tcl, xmpp/xmpp.tcl: Added a simple way to abort long
	  procedures (connection, stream opening, STARTTLS, compress, SASL,
	  authentication). The corresponding abortion procedure is stored in a
	  variable and is called if necessary.

	* xmpp/auth.tcl, xmpp/component.tcl, xmpp/compress.tcl, xmpp/https.tcl,
	  xmpp/iq.tcl, xmpp/poll.tcl, xmpp/roster.tcl, xmpp/sasl.tcl,
	  xmpp/socks4.tcl, xmpp/socks5.tcl, xmpp/starttls.tcl, xmpp/xmpp.tcl:
	  Changed syntax of debug calls.

	* xmpp/roster.tcl: Made parsing the server answer a bit more efficient.

	* xmpp/iq.tcl: Changed the way registered IQ handlers are stored in an
	  array.

	* xmpp/xmpp.tcl: Added comments before all defined procedures.

2008-10-06  Sergei Golovan  <sgolovan@nes.ru>

	* */*: Removed spaces at the end of lines and expanded tabs in all
	  sources (except TclXML code).

2008-10-05  Sergei Golovan  <sgolovan@nes.ru>

	* examples/*, tclxml/*, xmpp/*: Initial version of XMPP client
	  library. It includes a Tcl-only XML parser from some old version of
	  TclXML and a few examples.
